var students = [
    {
      id: 'B21DCDT017',
      name: 'Dương Đăng Minh',
      exams: [
        {
          id: 'Giữa Kì',
          name: 'Kì thi giữa kì',
          score: 9,
          status: 'Hoàn thành',
          time: '10:30 AM',
	  questions: [
          'Câu hỏi 1: Đội bóng nào vĩ đại nhất thế giới? Đáp án: MU',
          'Câu hỏi 2: Goat trong giới bóng đá là ai? Đáp Án: Cr7 ',
	'Câu hỏi 3: Đội bóng có khả năng vô địch epl năm nay? Đáp Án: ARS ',
	'Câu hỏi 4: Fb ra đời năm bao nhiêu? Đáp Án: 2004',
	'Câu hỏi 5: Ai đẹp trai nhất lớp B21CQCN01-B? Đáp Án: Dương Đăng Minh',
	'Câu hỏi 6: Cha đẻ của Iphone là ai? Đáp Án: Steve Paul Jobs',
	'Câu hỏi 7: Tay ném 3 điểm hay nhất tại NBA 2024 là ai? Đáp Án: Curry ',
	'Câu hỏi 8: Thầy giáo đẹp trai nhất PTIT? Đáp Án: thầy Khánh' ,
        ]
        },
        {
          id: 'Cuối kì',
          name: 'Kỳ thi cuối kì',
          score: 7,
          status: 'Hoàn thành',
          time: '2:00 PM',
	  questions: [
          'Câu hỏi 1: 11 có phải số nguyên tố hay không? Đáp Án: Có ',
          'Câu hỏi 2: AN đi đến phòng trọ 1 tiếng, nhà An xa phòng trọ 30km, vận tốc lý thuyết của An là? Đáp Án 30km/h  ',
          'Câu hỏi 3: Lớp có 32 học sinh, Liệu có 2 bạn trong lớp có cùng ngày sinh hay không? Đáp Án: Có ',
	'Câu hỏi 4: 3 bóng đèn mắc nối tiếp nhau, khi 1 bóng bị cháy thì 2 bóng còn lại có còn sáng hay không? Đáp Án: Có ',
	'Câu hỏi 5: Danilo có nghe blv không? Đáp Án: Không anh ta không nghe, Anh ta sút chứ không chuyền ',
	'Câu hỏi 6: Ca sĩ Mono có quan hệ gì với Sơn Tùng MTP? Đáp Án: anh em ',
	'Câu hỏi 7: MCK hay wxrdie hay hơn? Đáp Án: chắc chắn là MCK ',
	'Câu hỏi 8: Kevin De Bruyne là ai? Đáp Án: Tiểu Bruno ' ,
     
      ]
    },
	{
          id: '1 tiết',
          name: 'Kiểm tra 1 tiết',
          score: 7,
          status: 'Hoàn thành',
          time: '3:00 PM',
	  questions: [
          'Câu hỏi 1: Theo Anthony Nguyễn, có nên đeo Apple watch? Đáp Án: Không   ',
          'Câu hỏi 2: Xuân Ca hay Quỳnh bei ? Đáp Án: Quỳnh bei ',
          'Câu hỏi 3: Chu vi hình tròn? Đáp Án C = π × Đường kính ',
	'Câu hỏi 4: Đi xe 1 gương trái có bị bắt không? Đáp Án: Không ',
	'Câu hỏi 5: Đeo tai nghe đi xe máy có bị phạt không? Đáp Án: Có ',
	'Câu hỏi 6: Tác giả của Tình ta biển bạc đồng xanh là ai? Đáp Án: Nhà soạn nhạc Hoàng Sông Hương ',
	'Câu hỏi 7: Covid bùng nổ năm nào? Đáp Án 2020 ',
	'Câu hỏi 8: Thủ tướng Việt Nam hiện nay là ai? Đáp Án: Phạm Minh Chính ',
		]
		}
        ]
        },

{
      id: 'B21DCDT018',
      name: 'Bạn Hai',
      exams: [
        {
          id: 'Giữa Kì',
          name: 'Kì thi giữa kì',
          score: 0,
          status: 'Chưa Hoàn thành',
          time: '10:30 AM',
	  questions: [
          'Câu hỏi 1: Đội bóng nào vĩ đại nhất thế giới? Đáp án: MU',
          'Câu hỏi 2: Goat trong giới bóng đá là ai? Đáp Án: Cr7 ',
	'Câu hỏi 3: Đội bóng có khả năng vô địch epl năm nay? Đáp Án: ARS ',
	'Câu hỏi 4: Fb ra đời năm bao nhiêu? Đáp Án: 2004',
	'Câu hỏi 5: Ai đẹp trai nhất lớp B21CQCN01-B? Đáp Án: Dương Đăng Minh',
	'Câu hỏi 6: Cha đẻ của Iphone là ai? Đáp Án: Steve Paul Jobs',
	'Câu hỏi 7: Tay ném 3 điểm hay nhất tại NBA 2024 là ai? Đáp Án: Curry ',
	'Câu hỏi 8: Thầy giáo đẹp trai nhất PTIT? Đáp Án: thầy Khánh' ,
        ]
        },
        {
          id: 'Cuối kì',
          name: 'Kỳ thi cuối kì',
          score: 8,
          status: 'Hoàn thành',
          time: '2:00 PM',
	  questions: [
          'Câu hỏi 1: 11 có phải số nguyên tố hay không? Đáp Án: Có ',
          'Câu hỏi 2: AN đi đến phòng trọ 1 tiếng, nhà An xa phòng trọ 30km, vận tốc lý thuyết của An là? Đáp Án 30km/h  ',
          'Câu hỏi 3: Lớp có 32 học sinh, Liệu có 2 bạn trong lớp có cùng ngày sinh hay không? Đáp Án: Có ',
	'Câu hỏi 4: 3 bóng đèn mắc nối tiếp nhau, khi 1 bóng bị cháy thì 2 bóng còn lại có còn sáng hay không? Đáp Án: Có ',
	'Câu hỏi 5: Danilo có nghe blv không? Đáp Án: Không anh ta không nghe, Anh ta sút chứ không chuyền ',
	'Câu hỏi 6: Ca sĩ Mono có quan hệ gì với Sơn Tùng MTP? Đáp Án: anh em ',
	'Câu hỏi 7: MCK hay wxrdie hay hơn? Đáp Án: chắc chắn là MCK ',
	'Câu hỏi 8: Kevin De Bruyne là ai? Đáp Án: Tiểu Bruno ' ,
       
      ]
    },
	{
          id: '1 tiết',
          name: 'Kiểm tra 1 tiết',
          score: 9,
          status: 'Hoàn thành',
          time: '3:00 PM',
	  questions: [
          'Câu hỏi 1: Theo Anthony Nguyễn, có nên đeo Apple watch? Đáp Án: Không   ',
          'Câu hỏi 2: Xuân Ca hay Quỳnh bei ? Đáp Án: Quỳnh bei ',
          'Câu hỏi 3: Chu vi hình tròn? Đáp Án C = π × Đường kính ',
	'Câu hỏi 4: Đi xe 1 gương trái có bị bắt không? Đáp Án: Không ',
	'Câu hỏi 5: Đeo tai nghe đi xe máy có bị phạt không? Đáp Án: Có ',
	'Câu hỏi 6: Tác giả của Tình ta biển bạc đồng xanh là ai? Đáp Án: Nhà soạn nhạc Hoàng Sông Hương ',
	'Câu hỏi 7: Covid bùng nổ năm nào? Đáp Án 2020 ',
	'Câu hỏi 8: Thủ tướng Việt Nam hiện nay là ai? Đáp Án: Phạm Minh Chính ',
        ]
        }
	]
},
 
{
      id: 'B21DCDT019',
      name: 'Dương Hoàng Minh',
      exams: [
        {
          id: 'Giữa Kì',
          name: 'Kì thi giữa kì',
          score: 7,
          status: 'Hoàn thành',
          time: '10:30 AM',
	  questions: [
          'Câu hỏi 1: Đội bóng nào vĩ đại nhất thế giới? Đáp án: MU',
          'Câu hỏi 2: Goat trong giới bóng đá là ai? Đáp Án: Cr7 ',
	'Câu hỏi 3: Đội bóng có khả năng vô địch epl năm nay? Đáp Án: ARS ',
	'Câu hỏi 4: Fb ra đời năm bao nhiêu? Đáp Án: 2004',
	'Câu hỏi 5: Ai đẹp trai nhất lớp B21CQCN01-B? Đáp Án: Dương Đăng Minh',
	'Câu hỏi 6: Cha đẻ của Iphone là ai? Đáp Án: Steve Paul Jobs',
	'Câu hỏi 7: Tay ném 3 điểm hay nhất tại NBA 2024 là ai? Đáp Án: Curry ',
	'Câu hỏi 8: Thầy giáo đẹp trai nhất PTIT? Đáp Án: thầy Khánh' ,
        ]
        },
        {
          id: 'Cuối kì',
          name: 'Kỳ thi cuối kì',
          score: 9,
          status: 'Hoàn thành',
          time: '2:00 PM',
	  questions: [
          'Câu hỏi 1: 11 có phải số nguyên tố hay không? Đáp Án: Có ',
          'Câu hỏi 2: AN đi đến phòng trọ 1 tiếng, nhà An xa phòng trọ 30km, vận tốc lý thuyết của An là? Đáp Án 30km/h  ',
          'Câu hỏi 3: Lớp có 32 học sinh, Liệu có 2 bạn trong lớp có cùng ngày sinh hay không? Đáp Án: Có ',
	'Câu hỏi 4: 3 bóng đèn mắc nối tiếp nhau, khi 1 bóng bị cháy thì 2 bóng còn lại có còn sáng hay không? Đáp Án: Có ',
	'Câu hỏi 5: Danilo có nghe blv không? Đáp Án: Không anh ta không nghe, Anh ta sút chứ không chuyền ',
	'Câu hỏi 6: Ca sĩ Mono có quan hệ gì với Sơn Tùng MTP? Đáp Án: anh em ',
	'Câu hỏi 7: MCK hay wxrdie hay hơn? Đáp Án: chắc chắn là MCK ',
	'Câu hỏi 8: Kevin De Bruyne là ai? Đáp Án: Tiểu Bruno ' ,
       
      ]
    },
	{
          id: '1 tiết',
          name: 'Kiểm tra 1 tiết',
          score: 10,
          status: 'Hoàn thành',
          time: '3:00 PM',
	  questions: [
          'Câu hỏi 1: Theo Anthony Nguyễn, có nên đeo Apple watch? Đáp Án: Không   ',
          'Câu hỏi 2: Xuân Ca hay Quỳnh bei ? Đáp Án: Quỳnh bei ',
          'Câu hỏi 3: Chu vi hình tròn? Đáp Án C = π × Đường kính ',
	'Câu hỏi 4: Đi xe 1 gương trái có bị bắt không? Đáp Án: Không ',
	'Câu hỏi 5: Đeo tai nghe đi xe máy có bị phạt không? Đáp Án: Có ',
	'Câu hỏi 6: Tác giả của Tình ta biển bạc đồng xanh là ai? Đáp Án: Nhà soạn nhạc Hoàng Sông Hương ',
	'Câu hỏi 7: Covid bùng nổ năm nào? Đáp Án 2020 ',
	'Câu hỏi 8: Thủ tướng Việt Nam hiện nay là ai? Đáp Án: Phạm Minh Chính ',
        ]
        }
 ]
    },
{
      id: 'B21DCDT020',
      name: 'Dương Thành Minh',
      exams: [
        {
          id: 'Giữa Kì',
          name: 'Kì thi giữa kì',
          score: 6,
          status: 'Hoàn thành',
          time: '10:30 AM',
	  questions: [
          'Câu hỏi 1: Đội bóng nào vĩ đại nhất thế giới? Đáp án: MU',
          'Câu hỏi 2: Goat trong giới bóng đá là ai? Đáp Án: Cr7 ',
	'Câu hỏi 3: Đội bóng có khả năng vô địch epl năm nay? Đáp Án: ARS ',
	'Câu hỏi 4: Fb ra đời năm bao nhiêu? Đáp Án: 2004',
	'Câu hỏi 5: Ai đẹp trai nhất lớp B21CQCN01-B? Đáp Án: Dương Đăng Minh',
	'Câu hỏi 6: Cha đẻ của Iphone là ai? Đáp Án: Steve Paul Jobs',
	'Câu hỏi 7: Tay ném 3 điểm hay nhất tại NBA 2024 là ai? Đáp Án: Curry ',
	'Câu hỏi 8: Thầy giáo đẹp trai nhất PTIT? Đáp Án: thầy Khánh' ,
        ]
        },
        {
          id: 'Cuối kì',
          name: 'Kỳ thi cuối kì',
          score: 7,
          status: 'Hoàn thành',
          time: '2:00 PM',
	  questions: [
          'Câu hỏi 1: 11 có phải số nguyên tố hay không? Đáp Án: Có ',
          'Câu hỏi 2: AN đi đến phòng trọ 1 tiếng, nhà An xa phòng trọ 30km, vận tốc lý thuyết của An là? Đáp Án 30km/h  ',
          'Câu hỏi 3: Lớp có 32 học sinh, Liệu có 2 bạn trong lớp có cùng ngày sinh hay không? Đáp Án: Có ',
	'Câu hỏi 4: 3 bóng đèn mắc nối tiếp nhau, khi 1 bóng bị cháy thì 2 bóng còn lại có còn sáng hay không? Đáp Án: Có ',
	'Câu hỏi 5: Danilo có nghe blv không? Đáp Án: Không anh ta không nghe, Anh ta sút chứ không chuyền ',
	'Câu hỏi 6: Ca sĩ Mono có quan hệ gì với Sơn Tùng MTP? Đáp Án: anh em ',
	'Câu hỏi 7: MCK hay wxrdie hay hơn? Đáp Án: chắc chắn là MCK ',
	'Câu hỏi 8: Kevin De Bruyne là ai? Đáp Án: Tiểu Bruno ' ,
       
      ]
    },
	{
          id: '1 tiết',
          name: 'Kiểm tra 1 tiết',
          score: 10,
          status: 'Hoàn thành',
          time: '3:00 PM',
	  questions: [
          'Câu hỏi 1: Theo Anthony Nguyễn, có nên đeo Apple watch? Đáp Án: Không   ',
          'Câu hỏi 2: Xuân Ca hay Quỳnh bei ? Đáp Án: Quỳnh bei ',
          'Câu hỏi 3: Chu vi hình tròn? Đáp Án C = π x Đường kính ',
	'Câu hỏi 4: Đi xe 1 gương trái có bị bắt không? Đáp Án: Không ',
	'Câu hỏi 5: Đeo tai nghe đi xe máy có bị phạt không? Đáp Án: Có ',
	'Câu hỏi 6: Tác giả của Tình ta biển bạc đồng xanh là ai? Đáp Án: Nhà soạn nhạc Hoàng Sông Hương ',
	'Câu hỏi 7: Covid bùng nổ năm nào? Đáp Án 2020 ',
	'Câu hỏi 8: Thủ tướng Việt Nam hiện nay là ai? Đáp Án: Phạm Minh Chính ',
        ]
        }
      ]
    }
  ];
  
  
  
  function searchStudent() {
    var searchInput = document.getElementById('searchInput').value;
    var studentDetails = document.getElementById('studentDetails');
    studentDetails.innerHTML = '';
  
    var foundStudents = students.filter(function(student) {
      return student.name.toLowerCase().includes(searchInput.toLowerCase()) || student.id.toString() === searchInput;
    });
  
    if (foundStudents.length > 0) {
      for (var i = 0; i < foundStudents.length; i++) {
        var student = foundStudents[i];
        var studentInfo = document.createElement('div');
        studentInfo.innerHTML = '<h2>Thông tin sinh viên:</h2>' +
          '<p><strong>Mã số sinh viên:</strong> ' + student.id + '</p>' +
          '<p><strong>Tên sinh viên:</strong> ' + student.name + '</p>';
        studentDetails.appendChild(studentInfo);
  
        if (student.exams.length > 0) {
          var examsTable = document.createElement('table');
          examsTable.classList.add('exams-table');
          var tbody = document.createElement('tbody');
          for (var j = 0; j < student.exams.length; j++) {
            var exam = student.exams[j];
            var row = document.createElement('tr');
            row.innerHTML = '<td>' + exam.name + '</td>' +
              '<td>' + (exam.score !== null ? exam.score.toFixed(2) : 'Chưa có kết quả') + '</td>' +
              '<td>' + exam.status + '</td>' +
              '<td>' + exam.time + '</td>' +
              '<td><a href="#" onclick="showQuestionDetails(event, ' + i + ', ' + j + ')">Xem chi tiết</a></td>';
            tbody.appendChild(row);
          }
          examsTable.appendChild(tbody);
          studentDetails.appendChild(examsTable);
        }
      }
    } else {
      studentDetails.innerHTML = '<p>Không tìm thấy sinh viên.</p>';
    }
    var questionDetails = document.getElementById('questionDetails');
    questionDetails.style.display = 'none';
  }
  
  function showQuestionDetails(event, studentIndex, examIndex) {
    event.preventDefault();
    var questionDetails = document.getElementById('questionDetails');
    questionDetails.style.display = 'block';
    questionDetails.innerHTML = '<h3>Chi tiết câu hỏi:</h3><ul>';
    var exam = students[studentIndex].exams[examIndex];
    for (var i = 0; i < exam.questions.length; i++) {
      questionDetails.innerHTML += '<li>' + exam.questions[i] + '</li>';
    }
    questionDetails.innerHTML += '</ul>';
  }
  function handleKeyPress(event) {
    if (event.keyCode === 13) {
      searchStudent();
    }
  }

  function exportToExcel() {
    var studentsData = [];
  
    // Tạo mảng dữ liệu cho Excel
    for (var i = 0; i < students.length; i++) {
      var student = students[i];
      for (var j = 0; j < student.exams.length; j++) {
        var exam = student.exams[j];
        studentsData.push({
          'Mã Sinh viên': student.id,
          'Tên Sinh viên': student.name,
          'Kỳ thi': exam.name,
          'Điểm': exam.score,
          'Trạng thái': exam.status,
          'Thời gian': exam.time
        });
      }
    }
  
    // Tạo workbook mới
    var workbook = XLSX.utils.book_new();
    var worksheet = XLSX.utils.json_to_sheet(studentsData);
  
    // Thêm worksheet vào workbook
    XLSX.utils.book_append_sheet(workbook, worksheet, 'Dữ liệu Sinh viên');
  
    // Xuất file Excel
    XLSX.writeFile(workbook, 'DanhSachSinhVien.xlsx');
  }

  function otherPages() {
    document.getElementById('js-stats-page').addEventListener('click', () => {
      window.location = "http://127.0.0.1:5500/trangthongke.html#";
    });
    
    document.getElementById('js-dashboard-page').addEventListener('click', () => {
      window.location = "http://127.0.0.1:5500/dashboard.html#";
    });
    
    document.getElementById('js-customize-page').addEventListener('click', () => {
      window.location = "http://127.0.0.1:5500/customizeTesting.html";
    });
  }

  function validateLogin() {
    window.location = "http://127.0.0.1:5500/userlogin.html";
  }

  function myMenuFunction() {
    var i = document.getElementById("navMenu");
    if(i.className === "nav-menu") {
        i.className += " responsive";
    } else {
        i.className = "nav-menu";
    }
   }

   